<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>fielddata — fielddata • elastic</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="fielddata — fielddata"><meta name="description" content="Deep dive on fielddata details"><meta property="og:description" content="Deep dive on fielddata details"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">elastic</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.92</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/elastic.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rfhb/elastic/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>fielddata</h1>
      <small class="dont-index">Source: <a href="https://github.com/rfhb/elastic/blob/HEAD/R/fielddata.R" class="external-link"><code>R/fielddata.R</code></a></small>
      <div class="d-none name"><code>fielddata.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Deep dive on fielddata details</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Most fields are indexed by default, which makes them searchable. Sorting,
aggregations, and accessing field values in scripts, however, requires a
different access pattern from search.</p>
<p>Text fields use a query-time in-memory data structure called fielddata.
This data structure is built on demand the first time that a field is
used for aggregations, sorting, or in a script. It is built by reading
the entire inverted index for each segment from disk, inverting the
term-document relationship, and storing the result in memory, in the
JVM heap.</p>
<p>fielddata is disabled on text fields by default. Fielddata can consume a
lot of heap space, especially when loading high cardinality text fields.
Once fielddata has been loaded into the heap, it remains there for the
lifetime of the segment. Also, loading fielddata is an expensive process
which can cause users to experience latency hits. This is why fielddata
is disabled by default. If you try to sort, aggregate, or access values
from a script on a text field, you will see this exception:</p>
<p>"Fielddata is disabled on text fields by default. Set fielddata=true on
<code>your_field_name</code> in order to load fielddata in memory by uninverting
the inverted index. Note that this can however use significant memory."</p>
<p>To enable fielddata on a text field use the PUT mapping API, for example
<code>mapping_create("shakespeare", body = '{
  "properties": {
    "speaker": {
      "type":     "text",
      "fielddata": true
    }
  }
}')</code></p>
<p>You may get an error about <code>update_all_types</code>, in which case set
<code>update_all_types=TRUE</code> in <code>mapping_create</code>, e.g.,</p>
<p><code>mapping_create("shakespeare", update_all_types=TRUE, body = '{
  "properties": {
    "speaker": {
      "type":     "text",
      "fielddata": true
    }
  }
}')</code></p>
<p>See <a href="https://www.elastic.co/docs/reference/elasticsearch/mapping-reference/text#enable-fielddata-text-fields" class="external-link">https://www.elastic.co/docs/reference/elasticsearch/mapping-reference/text#enable-fielddata-text-fields</a>
for more information.</p>
    </div>

  </main></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ralf Herold, Scott Chamberlain.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

